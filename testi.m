
tic
t=0:0.01:10;
%halfSin(t,10);
%plot(t,halfSin(t,20))
toc

x=1:18;
X=1:0.5:18;
X=(X-1)/(X(end)-x(1))
y=[80 100 120 105 97 94 90 89 91 91 87 83 79 77.5 77 76.5 76.5 80];
Y=zeros(1,35);
Y(1:2:35)=y;
Y(2:2:34)=(y(1:end-1)+y(2:end))/2;
Y(4)=117;
%hold on
plot(X,Y)
XX=1:0.5:35;
YY=zeros(1,69);
YY(1:35)=Y;
YY(36:69)=Y(2:end);
length(YY)
plot(X,Y)%%%%%%%%%%%%%%%%%%%%%%%%

x=X;
y=Y;

m = length(y);
n = floor((m+1)/2);
z = fft(y)/m;

a0 = z(1);
an = 2*real(z(2:n));
a6 = z(n+1);
bn = -2*imag(z(2:n));

hold on
t = 0:0.001:1;
k = 1:length(an);
py = a0 + an*cos(2*pi*k'*t/1) ...
        + bn*sin(2*pi*k'*t/1) ...
        + a6*cos(2*pi*6*t/1); 

%plot(px,py)
plot(t,pulse(t))
    
function y=pulse(t)
    y=88.9714+ [1.6497 0.8238 -3.8228 -2.6109 -2.5753 -1.2275 -0.4288 0.1150...
        0.2299 0.2768 0.1518 -0.1697 -0.2533 -0.2212 -0.2729 -0.2774 -0.3586]*cos(2*pi*(1:17)'*t)+...
    [12.3386 7.7052 3.4974 1.5725 -0.2766 -1.2980 -1.0688 -0.7423 -0.4400 ...
    -0.0197 0.2096 0.3303 0.1752 0.2407 0.0817 0.1936 0.0847]*sin(2*pi*(1:17)'*t)...
        -0.1793*cos(2*pi*6*t);
end

